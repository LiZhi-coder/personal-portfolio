FROM golang:1.22-alpine AS build

WORKDIR /app

COPY apps/boolcore/backend/go.mod apps/boolcore/backend/go.sum ./
RUN go mod download

COPY apps/boolcore/backend/ ./
RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o /bin/boolcore ./cmd/server

FROM alpine:3.20

RUN adduser -D -H -s /sbin/nologin boolcore
USER boolcore

COPY --from=build /bin/boolcore /bin/boolcore

EXPOSE 8080
ENTRYPOINT ["/bin/boolcore"]
